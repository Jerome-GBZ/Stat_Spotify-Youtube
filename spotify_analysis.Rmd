---
title: "Projet Calcul Financier & Statistique : En avant la musique !"
author: "MAHI Riad & Jérôme GAMBIEZ"
date: "Mise à jour, le 28 Juin 2023"
output:
  pdf_document:
    toc: yes
  html_document:
    toc: yes
---
## 1. Introduction

Pour ce projet statistique, nous avons choisi un sujet original consistant à utiliser des musiques provenant de sites de streaming populaires tels que Spotify ou YouTube. 
Notre objectif est d'analyser un jeu de données composé de 50 titres parmi les cinq artistes les plus connus sur ces plateformes, afin d'en déduire une analyse répondant à certaines questions comme notamment : 
  - Qu'elle est la corrélation entre le genre musical et la dansabilité ?
  - Qu'elle est la relation entre l'énergie et la dansabilité d'une musique ? 
  - Est-ce que l'énergie d'une musique influence la propension d'un utilisateur à l'apprécier ? 
  - Est-ce que l'énergie d'une musique influence la dansabilité ?

Au cours de cette étude, nous allons approfondir notre compréhension sur les éventuelles interconnexions entre eux.

Peut-on identifier des caractéristiques musicales communes parmi les titres les plus appréciés par les utilisateurs  ?
Nous y répondrons en analysant les données de manière univariée, bivariée et multivariée.

La source de notre jeu de donnée provient du site Kaggle.com: \newline
https://www.kaggle.com/datasets/salvatorerastelli/spotify-and-youtube

**Mise en place du jeu de donnée:**
```{r}
library(ggplot2)
library(dplyr)

dataPath <- "./Spotify_Youtube.csv"
data <- read.csv(dataPath, header=TRUE, stringsAsFactors=FALSE, nrows=50)

# Création d'un nouveau jeu de données avec les colonnes sélectionnées
data <- data %>%
  select(Danceability, Energy, Views, Album_type)

# Affichage les premières lignes du nouveau jeu de données
head(data)
```

**Netoyage des données**\newline\newline
Le jeu de données était plutot propre dans ca globalité, il ne manquait aucun ligne et aucune colonne. 
Cependant, nous avons décidé de supprimer les colonnes qui ne nous semblaient pas pertinentes pour notre étude. 
Nous avons décidé de garder uniquement les colonnes suivantes :
  - Danceability
  - Energy
  - Views
  - Album_type

Et nous avons du recoder la colonne "Views" qui était le nombre de vues de la musique en "Freq_listen".
Car c'était une variable quantitative et nous avons décidé de la transformer en variable qualitative. 
"Freq_listen" est représenté en trois catégories : Peu écouté / Moyennement écouté / Très écouté.

Dans notre étude, nous avons sélectionné deux variables qualitatives : "Album_type" et "Freq_listen".

La variable "Album_type" indique si la musique est issue d'un album ou si c'est un single. Cette information nous permet de distinguer les différentes formes de publication des titres musicaux.

La variable "Freq_listen" représente la fréquence d'écoute des titres. Nous avons converti la variable quantitative initiale "Views" (nombre de vues) en une variable qualitative pour simplifier l'analyse.
Nous avons divisé les titres en trois catégories :
  - "Peu écouté" : Cette catégorie regroupe les titres qui ont accumulé un nombre de vues inférieur ou égal à 100 millions. Ces titres peuvent être considérés comme moins populaires ou moins diffusés.
  - "Moyennement écouté" : Cette catégorie concerne les titres qui ont reçu un nombre de vues compris entre 100 millions et 500 millions. Ces titres ont une popularité moyenne.
  - "Très écouté" : Cette catégorie englobe les titres qui ont accumulé un nombre de vues supérieur à 500 millions. Ces titres sont considérés comme très populaires ou ayant une diffusion élevée. 
  
En utilisant ces variables qualitatives, nous pourrons examiner les relations entre les caractéristiques musicales et la popularité des titres, ainsi que les différences entre les albums et les singles.

```{r}
# Récupération de la colonne album_type (album ou single)
album_type <- table(data$Album_type)
album_type_df <- as.data.frame(album_type)
album_type_df <- album_type_df[order(album_type_df$Freq, decreasing = TRUE), ]

# Récupération et traitement de la colonne fréquence écoute 
data <- data %>%
  mutate(Freq_listen = case_when(
    data$Views <= 100000000 ~ "Peu écouté",
    data$Views > 100000000 & data$Views <= 500000000 ~ "Moyennement écouté",
    data$Views > 500000000 ~ "Très écouté",
    TRUE ~ NA_character_
  ))

freq_listen <- table(data$Freq_listen)

freq_listen_df <- as.data.frame(freq_listen)
freq_listen_df <- freq_listen_df[order(freq_listen_df$Freq, decreasing = TRUE), ]
```

**Variables quantitative**\newline\newline
Les variables quantitatives que nous avons sélectionnées pour notre étude sont la "Danceability" (dansabilité) et l'"Energy" (énergie) d'une musique.

La "Danceability" est un indicateur quantitatif qui mesure la probabilité de danser sur une musique.
Elle peut varier de 0 à 1, où une valeur proche de 1 indique une musique facilement dansable et une valeur proche de 0 indique une musique moins propice à la danse.

"L'Energy" représente également une mesure quantitative qui évalue le niveau d'intensité et d'activité ressenties dans un morceau de musique. 
Elle peut également varier de 0 à 1, où une valeur élevée indique une musique énergique et intense, tandis qu'une valeur plus faible indique une musique plus calme ou apaisante.

En analysant ces variables quantitatives, nous pourrons examiner la corrélation entre le genre musical et la dansabilité, ainsi que la relation entre l'énergie et la dansabilité d'une musique. 

## 2. Analyse univariée

**Répartitions des musiques album/single**
```{r}
pie_chart <- ggplot(album_type_df, aes(x = "", y = Freq, fill = Var1)) +
  geom_bar(stat = "identity", width = 1) +
  coord_polar("y", start = 0) +
  labs(title = "Répartition des types d'albums", fill = "Type d'album") +
  theme_void() +
  geom_text(aes(label = Freq), position = position_stack(vjust = 0.5), size = 4)

pie_chart
```

On observe que parmis notre échantillon, il y a près de 88% musique provenant d'album et 12% de single. 
Les titres d'albums sont dont prédominant dans nos données.

**Répartition des fréquences d'écoute**
```{r}
pie_chart_freq_list <- ggplot(freq_listen_df, aes(x = "", y = Freq, fill = Var1)) +
  geom_bar(stat = "identity", width = 1) +
  coord_polar("y", start = 0) +
  labs(title = "Répartition par catégorie d'écoute", fill = "Catégorie d'écoute") +
  theme_void() +
  geom_text(aes(label = Freq), position = position_stack(vjust = 0.5), size = 4)

pie_chart_freq_list
```

D'après la répartition des fréquences d'écoute dans notre échantillon, nous pouvons observer que les musiques sont relativement équilibrées entre les différentes catégories d'écoute.
"Peu écouté" => 36%
"Moyennement écouté" => 30%
"Très écouté" => 34%

Cette répartition équilibrée des fréquences d'écoute nous permettrons d'évaluer si ces caractéristiques ont une influence sur la popularité des titres.

### Représentation graphique de la répartition

**Dancabilité**
```{r}
boxplot_danceability <- ggplot(data, aes(y = Danceability)) +
  geom_boxplot(fill = "lightblue", color = "black") +
  labs(title = "Distribution de la dançabilité", y = "Dançabilité") +
  theme_minimal()

boxplot_danceability
```

En examinant le diagramme, on peut constater que la majorité des musiques analysées, soit environ 58 %, ont une danceability élevée. Cela indique que ces morceaux sont adaptés à la danse et ont un potentiel élevé pour inciter les gens à se déplacer et à bouger sur la piste de danse.

De plus, le diagramme révèle que 25 % des musiques ont un effet dansant sur environ 70 % de la population. Cela suggère que ces morceaux sont particulièrement accrocheurs et entraînants, capables d'engager un large public et de susciter l'envie de danser chez une majorité de personnes.

Enfin, il est intéressant de noter que 50 % des musiques ont un effet dansant sur une personne sur deux. Cela signifie que la danceability de ces morceaux est plus subjective et peut varier d'une personne à l'autre. Certains individus peuvent ressentir une forte envie de danser en les écoutant, tandis que d'autres peuvent ne pas être aussi réceptifs à leur effet dansant. 

**Énergie**

```{r}
boxplot_energy <- ggplot(data, aes(y = Energy)) +
  geom_boxplot(fill = "lightblue", color = "black") +
  labs(title = "Distribution de l'energie d'une musique", y = "Énergie") +
  theme_minimal()
boxplot_energy
```
L'analyse du diagramme en boîte à moustaches révèle plusieurs informations importantes concernant l'énergie des morceaux de musique. Plus l'énergie est proche de 1.0, plus elle est rapides, fortes et bruyantes.

En examinant les différentes parties du diagramme, nous pouvons constater que la médiane à 0.75. On peut donc conclure 75% des morceaux analysés présentent une énergie relativement élevée supérieur à 0.67.

La boîte à moustaches indique également que 25% des morceaux ont une énergie supérieure à 0,87, ce qui suggère une intensité, une vitesse et un niveau sonore plus élevés. Ces morceaux pourraient correspondre à des genres musicaux tels que le rock, le metal ou d'autres styles de musique agressifs et dynamiques. On retrouve des groupes comme Metallica ou Red Hot Chili Peppers.

D'autre part, 25% des morceaux ont une énergie inférieure à 0,66, ce qui indique une énergie plus basse. Ces morceaux pourraient être plus calmes, plus lents et moins bruyants. On retrouve le musicien Coldlay qui propose des musiques appelé Soft rock.

**Conclusion des deux moustaches**

En analysant les deux diagrammes ensemble, nous pouvons effectivement observer une corrélation entre la danceability et l'énergie des morceaux de musique. Il semble y avoir une tendance où les morceaux ayant une forte danceability ont également une énergie élevée, supérieure à 0,65.

En se basant sur cette observation, il est intéressant de noter que les musiques les plus dansantes sont celles de 50 Cent, un artiste de hip-hop/rap. Ses morceaux ont une énergie se situant entre 0,65 et 0,75, ce qui correspond à une intensité sonore élevée et une propension à inciter les auditeurs à se déplacer et à danser.
## Estimation et intervalles de confiance

**Analyse de la dancabilité**
```{r}
dancabilite  <- data$Danceability

var(dancabilite)
mean(dancabilite)

par(mfrow=c(1,2))
hist(dancabilite , main="repartition de la dancabilité des musiques ",xlab="dancabilite",prob=T)
points(seq(0,30,0.01),dnorm(seq(0,30,0.01),mean(dancabilite),sd(dancabilite)),col=2,type="l")
qqnorm(dancabilite)
abline(mean(dancabilite),sd(dancabilite),col=2)
interval=t.test(dancabilite)
interval$conf.int
```


L'histogramme représente la répartition de la danceability des morceaux de musique étudiés. La variable dancabilite a une variance (var) de 0.0210791 et une moyenne (mean) de 0.59372. Cela indique que les valeurs de danceability sont relativement concentrées autour de la moyenne et présentent une faible dispersion. 


**Analyse de l'energie**
```{r}
energie <- data$Energy

var(energie)
mean(energie)

par(mfrow=c(1,2))

hist(energie, main="Répartition énergie", xlab="Énergie", prob=T, ylim=c(0, 2.5), xlim=c(0, 1.5))
points(seq(0, 150, 0.01), dnorm(seq(0, 150, 0.01), mean(energie), sd(energie)), col=2, type="l")

qqnorm(energie)
abline(mean(energie), sd(energie), col=2)

interval <- t.test(energie)
interval$conf.int
```
Dans cette analyse, nous nous sommes intéressés à la répartition de l'énergie dans les morceaux de musique.

La variance de l'énergie est de 0.0287, ce qui indique une certaine dispersion des valeurs autour de la moyenne. La moyenne de l'énergie est de 0.7394, ce qui représente un niveau moyen d'énergie dans les morceaux étudiés.

L'histogramme de la répartition de l'énergie dans les morceaux de musique met en évidence que la majorité des valeurs se concentrent autour d'une moyenne de 0.73938, avec une variance de 0.02873404. De plus, en utilisant la loi normale comme référence dans notre analyse, nous remarquons que la distribution des données présente une tendance à suivre approximativement une courbe en forme de cloche, ce qui suggère que la répartition de l'énergie dans les morceaux peut être caractérisée par cette distribution.

## 3. Analyse multivariée

### Analyse quanti x quali
Nous avons choisi de prendre comme varaible quantitative **la dancabilité** et comme qualitative la **fréquence d'écoute d'un titre**.

• Donner les résumés statistiques, histogrammes et/ou bloxplot par sous-population.
```{r}
boxplot(data$Danceability ~ data$Freq_listen, main="Danceability en fonction de la fréquence d'écoute", xlab="Fréquence d'écoute", ylab="Danceability")
```

On observe une répartition assez similaire entre les musiques moyennement écoutées et les musiques très écoutées. Cependant, la variable qui se démarque le plus est celle des musiques moyennement écoutées, qui présente une danseabilité supérieure aux deux autres variables. Toutefois, cette variable présente également une plus grande dispersion que les deux autres. En effet, son premier quartile se situe à une danseabilité de 0.3 et son troisième quartile à 0.9, avec une médiane aux alentours de 0.7. En revanche, pour les deux autres variables, le premier quartile se situe aux alentours de 0.45 et le troisième quartile aux alentours de 0.7.

```{r}
summary(data$Danceability[data$Freq_listen == "peu écouté"])
summary(data$Danceability[data$Freq_listen == "moyen écouté"])
summary(data$Danceability[data$Freq_listen == "très écouté"])
```

**Dancabilité par fréquence d'écoute:**
```{r} 
par(mfrow=c(1,3))
hist(data$Danceability[data$Freq_listen == "Peu écouté"], main="Peu écouté", xlab="Danceability", ylab="Fréquence")
hist(data$Danceability[data$Freq_listen == "Moyennement écouté"], main="Moyennement écouté", xlab="Danceability", ylab="Fréquence")
hist(data$Danceability[data$Freq_listen == "Très écouté"], main="Très écouté", xlab="Danceability", ylab="Fréquence")
```

**Calcule des rapports de corrélations:**
```{r}
data$Freq_listen_numeric <- factor(data$Freq_listen)
data$Freq_listen_numeric <- as.numeric(data$Freq_listen_numeric)
correlation <- cor(dancabilite, data$Freq_listen_numeric, use = "pairwise.complete.obs")
correlation
```

Il existe une corrélation très faible et négative (-0.0513819) entre la fréquence d'écoute et la danseabilité des musiques. Cela suggère qu'il n'y a pas de relation significative entre ces deux variables dans l'échantillon étudié. En d'autres termes, la fréquence d'écoute d'une musique ne semble pas être un facteur déterminant de sa danseabilité, du moins dans le contexte de ce jeu de données spécifique.

Cela signifie que, d'après les données analysées, il n'existe qu'une très légère tendance indiquant que plus un morceau de musique est écouté fréquemment, moins il est susceptible d'être dansant. Cependant, il est important de noter que cette corrélation est proche de zéro, ce qui suggère qu'il n'y a pas de relation linéaire significative entre la danseabilité et la fréquence d'écoute des morceaux.

Ce résultat suggère qu'il y a pas de preuve pour dire qu'une fréquence d'écoute élevée soit directement liée à une danseabilité. 


• Faire le test d’égalité des moyennes. Spécifier les hypothèses. Conclure ?

Hypothèses :

Hypothèse nulle (H0) : Il n'y a pas de différence significative entre les moyennes des groupes de fréquence d'écoute.

Hypothèse alternative (H1) : Il existe une différence significative entre au moins deux des moyennes des groupes de fréquence d'écoute.

```{r}
# Effectuer le test d'ANOVA
model <- aov(Danceability ~ Freq_listen, data = data)

# Résumé des résultats
summary(model)
```

Nous avons utilisé un seuil de signification de 0,05 pour évaluer la différence entre les groupes. La valeur p calculée pour notre test est de 0,723, ce qui est supérieur à notre seuil de signification. Cela signifie que nous n'avons pas trouvé suffisamment de preuves statistiques pour rejeter l'hypothèse nulle.

Nos résultats indiquent qu'il n'y a pas de différence significative dans la danseabilité des morceaux de musique en fonction de la fréquence d'écoute. Autrement dit, que les morceaux soient peu écoutés, moyennement écoutés ou très écoutés, cela n'a pas d'impact statistiquement significatif sur leur danseabilité.

### Analyse quali x quali
Nous avons choisi de prendre comme varaible qualitative **Album_type** et la **fréquence d'écoute d'un titre**.
Maintenant, nous allons procéder au test d'indépendance pour évaluer s'il existe une relation significative entre ces deux variables.

• Faire le tableau de contingence, proposer une représentation graphique.

Lors de l'analyse de notre jeu de données, nous avons constaté que la répartition entre les singles et les albums était déséquilibrée, avec seulement 6 singles (12%) et 44 albums (88%) :
```{r}
table(data$Album_type)
```
Cette répartition peut avoir une incidence sur nos conclusions, car les données ne sont pas homogènes. Il faut noter que la taille de l'échantillon de singles est relativement petite, ce qui peut affecter la représentativité de nos résultats.

```{r}
# Tableau de contingence
table_contingency <- table(data$Freq_listen, data$Album_type)

# Affichage du tableau de contingence
print(table_contingency)

# Graphique
contingency <- barplot(table_contingency, main="Fréquence d'écoute en fonction du type d'album", 
        xlab="Fréquence d'écoute", ylab="Nombre de morceaux", col=c("blue", "red", "orange"),
        legend = c("Peu écouté", "Moyennement écouté", "Très écouté"))

# Affichage du graphique de contingence
contingency
```

Nous observons que la fréquence d'écoute des morceaux de musique ne semble pas être influencée par le fait qu'ils soient inclus dans un album ou qu'ils soient des singles. Cela indique que la présence d'un morceau dans un album ne garantit pas nécessairement qu'il sera plus écouté ou moins écouté.

Malgré que tous les singles soit dans la catégorie "Moyennement écouté" cela ne veut pas dire qu'un sigle sera forcement dans cette catégorie.

En conclusion, les résultats actuels ne permettent pas de tirer des conclusions solides sur la relation entre le type d'album (album ou single) et la fréquence d'écoute des morceaux de musique.

• Faire le test d’indépendance. Spécifier les hypothèses. Conclure ?

Pour effectuer le test d'indépendance, nous formulons les hypothèses suivantes :

Hypothèse nulle (H0) : La fréquence d'écoute d'un titre est indépendante du type d'album.
Hypothèse alternative (H1) : La fréquence d'écoute d'un titre est dépendante du type d'album.
Pour effectuer le test, nous utiliserons une analyse de chi-carré (test du chi-carré d'indépendance). Ce test nous permettra de déterminer si les différences observées entre les fréquences d'écoute et le type d'album sont statistiquement significatives.

Je vais maintenant procéder à l'exécution du test d'indépendance. Veuillez patienter un instant.

```{r}
table_contingency <- table(data$Freq_listen, data$Album_type)

# Test d'indépendance (chi-carré)
result <- chisq.test(table_contingency)
print(result)
```

Sur la base de ces résultats, nous pouvons conclure ce qui suit :

La valeur de p obtenue (0.001337) est inférieure à notre seuil de significativité de 0.05. Par conséquent, nous rejetons l'hypothèse nulle selon laquelle la fréquence d'écoute d'un titre est indépendante du type d'album.

Cela suggère qu'il existe une relation significative entre la fréquence d'écoute des morceaux de musique et le type d'album (album ou single). En d'autres termes, le type d'album a une influence sur la fréquence d'écoute des morceaux.

### Analyse quanti x quanti
Noys avons choisi de prendre comme varaible quantitative **la dancabilité** et l'**energie**.

• Tracer le nuage de point, tracer la droite des moindre carrés
```{r}
  # Nuage de points
  plot(data$Danceability, data$Energy, main="Danceability en fonction de l'Energy", 
      xlab="Danceability", ylab="Energy", pch=19)

  # Droite des moindres carrés
  abline(lm(data$Energy ~ data$Danceability), col="red")
```

• Calculer le coefficient de corrélation linéaire
```{r}
# Calcul du coefficient de corrélation linéaire
cor(data$Danceability, data$Energy)
```
Après avoir calculé le coefficient de corrélation linéaire entre les variables "Danceability" et "Energy", nous obtenons un résultat de 0.1730491.

Ce coefficient de corrélation linéaire mesure la force et la direction de la relation linéaire entre les deux variables. Dans notre cas, le coefficient de corrélation est proche de zéro, ce qui suggère une faible corrélation linéaire entre la dancabilité et l'énergie des morceaux de musique.

• Tester la pertinence de la régression linéaire.
```{r}
# Régression linéaire
model <- lm(data$Energy ~ data$Danceability)

# Résumé des résultats
summary(model)
```

Après avoir effectué la régression linéaire de la variable "Energy" en fonction de la variable "Danceability" L'équation de régression obtenue est : Energy = 0.6194 + 0.2020 * Danceability. Cela signifie que pour chaque unité d'augmentation de la dancabilité, on peut s'attendre à une augmentation de 0.2020 dans l'énergie des morceaux de musique.

L'estimation du coefficient d'interception est de 0.6194 avec une erreur standard de 0.1014. Ce coefficient représente la valeur de l'énergie lorsque la dancabilité est égale à zéro. De même pour l'estimation du coefficient de pente de la dancabilité est de 0.2020 avec une erreur standard de 0.1660.

Le test de significativité pour la pente dancabilité montre un t-value de 1.217 et une valeur de p de 0.229. Cette valeur de p élevée indique que la relation entre la dancabilité et l'énergie n'est pas significative dans notre modèle.

L'analyse de variance (F-statistic) donne une valeur de 1.482 avec un degré de liberté de 1 et 48. Le p-value associé est de 0.2294, ce qui indique que le modèle de régression dans son ensemble n'est pas significatif.

Pour conclure, les résultats obtenu dans notre analyse de régression linéaire, il n'y a pas suffisamment de preuves pour soutenir la pertinence du modèle de régression linéaire pour prédire l'énergie des morceaux de musique en fonction de leur dancabilité. La dancabilité seule ne semble pas être un prédicteur significatif de l'énergie. D'autres facteurs ou variables pourraient être nécessaires pour améliorer la pertinence du modèle.